# 羊咩快报数据库设计 - PlantUML 图表说明

## 图表文件列表

本目录包含了羊咩快报AI资讯平台的完整数据库设计PlantUML图表，帮助开发团队理解数据库结构和业务逻辑。

### 1. database_erd.puml - 完整实体关系图
**用途**: 展示所有数据表及其完整的字段定义和关系
**包含内容**:
- 所有34个数据表的完整结构
- 主键、外键、索引定义  
- 字段类型和约束
- 表间关系和基数

**适用场景**: 数据库开发、表结构查阅、SQL编写参考

### 2. database_architecture.puml - 分层架构图  
**用途**: 从业务架构角度展示数据库的分层设计
**包含内容**:
- 用户管理层 (User Management Layer)
- 内容管理层 (Content Management Layer)  
- AI服务层 (AI Service Layer)
- 社区互动层 (Community Layer)
- 行为分析层 (Analytics Layer)
- 推荐系统层 (Recommendation Layer)
- 通知系统层 (Notification Layer)
- 系统配置层 (System Configuration Layer)
- 管理后台层 (Admin Layer)

**适用场景**: 系统架构设计、模块划分、团队分工

### 3. ai_content_flow.puml - AI内容生成流程图
**用途**: 展示从新闻爬取到AI内容生成的完整数据流程
**包含内容**:
- 新闻源爬取流程
- AI内容生成任务调度
- 文本、音频、视频生成流程
- 内容审核和发布流程
- 用户交互和数据反馈循环

**适用场景**: 业务流程理解、AI服务集成、数据处理逻辑

### 4. core_entities.puml - 核心实体关系图
**用途**: 突出显示最重要的核心实体和关系
**包含内容**:
- 用户(users)
- 原始新闻(raw_news)  
- AI解说(ai_commentary)
- 音视频内容(ai_audio_content, ai_video_content)
- 播放历史(play_history)
- 推荐系统(recommendations)
- 用户画像(user_profiles)

**适用场景**: 快速理解核心业务逻辑、新团队成员介绍

## 图表使用说明

### 如何查看PlantUML图表

1. **在线查看**: 访问 [PlantUML在线编辑器](http://www.plantuml.com/plantuml/uml/)
2. **VSCode插件**: 安装PlantUML插件，可直接预览
3. **IntelliJ IDEA**: 安装PlantUML插件
4. **命令行生成**: 
   ```bash
   java -jar plantuml.jar *.puml
   ```

### 图表更新规范

当数据库结构发生变更时，请同步更新相应的PlantUML文件：

1. **表结构变更**: 更新 `database_erd.puml`
2. **新增业务模块**: 更新 `database_architecture.puml`  
3. **业务流程优化**: 更新 `ai_content_flow.puml`
4. **核心逻辑调整**: 更新 `core_entities.puml`

### 图表设计原则

1. **层次清晰**: 使用包(package)和分组来组织相关实体
2. **关系明确**: 使用标准UML关系符号表示实体关系
3. **注释丰富**: 为关键实体和关系添加业务说明
4. **颜色区分**: 使用不同颜色区分不同业务模块
5. **简洁易读**: 避免过度复杂，保持图表可读性

## 数据库设计亮点

### 1. AI驱动的内容生成
- 支持多种AI模型配置和切换
- 完整的任务队列和状态管理
- 成本控制和性能监控

### 2. 智能推荐系统
- 多维度用户画像分析
- 多种推荐算法支持
- 实时推荐效果反馈

### 3. 高性能数据存储
- 合理的索引设计
- 分区和归档策略
- 读写分离支持

### 4. 灵活的内容管理
- 支持音频、视频、图文多种形态
- 智能标签和分类系统
- 内容质量评分机制

### 5. 完善的社区功能
- 用户关系管理
- 多层级评论系统
- 社交互动数据分析

## 开发建议

1. **渐进式开发**: 优先实现核心实体，逐步扩展功能模块
2. **数据一致性**: 重视外键约束和事务处理
3. **性能优化**: 关注热点数据的查询优化
4. **监控体系**: 建立完善的数据库性能监控
5. **备份策略**: 制定数据备份和恢复方案

---

*图表最后更新时间: 2024年1月*
*对应数据库设计版本: v1.0*