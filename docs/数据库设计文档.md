# 羊咩快报 - 数据库设计文档

## 数据库架构概述

本项目采用关系型数据库设计，针对AI资讯解说平台的特点，主要包含用户管理、资讯内容、AI生成内容、社区互动、推荐系统等核心模块。

## 核心数据模型

### 1. 用户系统 (User System)

#### 1.1 用户表 (users)
```sql
CREATE TABLE users (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    nickname VARCHAR(50),
    avatar_url VARCHAR(255),
    phone VARCHAR(20),
    birth_date DATE,
    gender ENUM('male', 'female', 'other'),
    bio TEXT,
    is_active BOOLEAN DEFAULT TRUE,
    is_verified BOOLEAN DEFAULT FALSE,
    premium_until DATETIME NULL,
    interest_tags JSON, -- 用户兴趣标签
    listening_preferences JSON, -- 听音偏好(语速、音色等)
    location VARCHAR(100), -- 位置信息(用于本地资讯推荐)
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    last_login_at TIMESTAMP NULL,
    
    INDEX idx_username (username),
    INDEX idx_email (email),
    INDEX idx_created_at (created_at),
    INDEX idx_location (location)
);
```

#### 1.2 用户偏好设置表 (user_preferences)
```sql
CREATE TABLE user_preferences (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    language VARCHAR(10) DEFAULT 'zh-CN',
    theme ENUM('light', 'dark', 'auto') DEFAULT 'auto',
    audio_quality ENUM('low', 'medium', 'high') DEFAULT 'medium',
    auto_play BOOLEAN DEFAULT TRUE,
    notification_enabled BOOLEAN DEFAULT TRUE,
    push_news BOOLEAN DEFAULT TRUE, -- 新闻推送
    push_comments BOOLEAN DEFAULT TRUE, -- 评论通知
    preferred_voice VARCHAR(50) DEFAULT 'standard_female', -- 偏好AI声音
    playback_speed DECIMAL(3,1) DEFAULT 1.0, -- 播放倍速
    scene_preferences JSON, -- 场景偏好(早报、夜听等)
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    UNIQUE KEY unique_user_preference (user_id)
);
```

### 2. 资讯内容系统 (News Content System)

#### 2.1 资讯分类表 (news_categories)
```sql
CREATE TABLE news_categories (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(50) NOT NULL,
    name_en VARCHAR(50),
    description TEXT,
    icon_url VARCHAR(255),
    color_code VARCHAR(7),
    parent_id BIGINT NULL,
    sort_order INT DEFAULT 0,
    is_active BOOLEAN DEFAULT TRUE,
    keywords JSON, -- 分类关键词，用于自动分类
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (parent_id) REFERENCES news_categories(id) ON DELETE SET NULL,
    INDEX idx_parent_id (parent_id),
    INDEX idx_sort_order (sort_order)
);
```

#### 2.2 资讯来源表 (news_sources)
```sql
CREATE TABLE news_sources (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL,
    website_url VARCHAR(255),
    rss_url VARCHAR(255),
    api_endpoint VARCHAR(255),
    source_type ENUM('rss', 'api', 'crawler') NOT NULL,
    credibility_score DECIMAL(3,2) DEFAULT 0.80, -- 可信度评分
    is_active BOOLEAN DEFAULT TRUE,
    crawl_interval INT DEFAULT 3600, -- 爬取间隔(秒)
    last_crawled_at TIMESTAMP NULL,
    config JSON, -- 爬取配置
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    INDEX idx_source_type (source_type),
    INDEX idx_last_crawled (last_crawled_at)
);
```

#### 2.3 资讯元数据表 (news_metadata) 
```sql
CREATE TABLE news_metadata (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    source_id BIGINT NOT NULL,
    title VARCHAR(500) NOT NULL,
    summary TEXT,
    author VARCHAR(100),
    source_url VARCHAR(500) UNIQUE NOT NULL,
    cover_image_url VARCHAR(500), -- 封面图片
    published_at TIMESTAMP NOT NULL,
    crawled_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    language VARCHAR(10) DEFAULT 'zh-CN',
    category_id BIGINT,
    content_type ENUM('article', 'video', 'audio') NOT NULL, -- 内容类型
    tags JSON, -- 标签数组
    keywords JSON, -- 关键词数组
    sentiment_score DECIMAL(3,2), -- 情感分数 (-1到1)
    importance_score DECIMAL(3,2), -- 重要性分数 (0到1)
    view_count BIGINT DEFAULT 0, -- 浏览次数
    like_count INT DEFAULT 0, -- 点赞数
    share_count INT DEFAULT 0, -- 分享数
    comment_count INT DEFAULT 0, -- 评论数
    duration INT NULL, -- 音视频时长(秒)，文章为NULL
    is_processed BOOLEAN DEFAULT FALSE,
    is_duplicate BOOLEAN DEFAULT FALSE,
    duplicate_of BIGINT NULL,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (source_id) REFERENCES news_sources(id) ON DELETE CASCADE,
    FOREIGN KEY (category_id) REFERENCES news_categories(id) ON DELETE SET NULL,
    FOREIGN KEY (duplicate_of) REFERENCES news_metadata(id) ON DELETE SET NULL,
    INDEX idx_source_id (source_id),
    INDEX idx_published_at (published_at),
    INDEX idx_content_type (content_type),
    INDEX idx_category_id (category_id),
    INDEX idx_is_processed (is_processed),
    INDEX idx_importance_score (importance_score),
    INDEX idx_view_count (view_count),
    INDEX idx_is_active (is_active),
    FULLTEXT idx_search (title, summary)
);
```

#### 2.4 文章内容表 (article_content)
```sql
CREATE TABLE article_content (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    news_id BIGINT NOT NULL, -- 关联资讯元数据
    content TEXT NOT NULL, -- 文章正文内容
    html_content LONGTEXT, -- HTML格式内容
    markdown_content LONGTEXT, -- Markdown格式内容
    content_structure JSON, -- 内容结构化数据（章节、段落等）
    word_count INT DEFAULT 0, -- 字数统计
    read_time_estimate INT DEFAULT 0, -- 预估阅读时间(分钟)
    tts_enabled BOOLEAN DEFAULT TRUE, -- 是否支持TTS
    tts_script TEXT, -- TTS专用脚本（优化语音播报）
    related_images JSON, -- 文章内图片数组
    related_links JSON, -- 相关链接
    seo_description VARCHAR(500), -- SEO描述
    seo_keywords VARCHAR(300), -- SEO关键词
    content_quality_score DECIMAL(3,2), -- 内容质量评分
    readability_score DECIMAL(3,2), -- 可读性评分
    is_original BOOLEAN DEFAULT FALSE, -- 是否原创
    plagiarism_check_result JSON, -- 查重结果
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (news_id) REFERENCES news_metadata(id) ON DELETE CASCADE,
    UNIQUE KEY unique_news_article (news_id),
    INDEX idx_word_count (word_count),
    INDEX idx_read_time (read_time_estimate),
    INDEX idx_quality_score (content_quality_score),
    INDEX idx_tts_enabled (tts_enabled),
    FULLTEXT idx_content_search (content, tts_script)
);
```

#### 2.5 视频内容表 (video_content)
```sql
CREATE TABLE video_content (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    news_id BIGINT NOT NULL, -- 关联资讯元数据
    video_url VARCHAR(500) NOT NULL, -- 视频文件URL
    backup_video_urls JSON, -- 备用视频URL数组
    thumbnail_url VARCHAR(500), -- 缩略图
    poster_url VARCHAR(500), -- 海报图
    duration INT NOT NULL, -- 视频时长(秒)
    resolution VARCHAR(20), -- 分辨率 1080p, 720p等
    file_size BIGINT, -- 文件大小(字节)
    bitrate INT, -- 比特率
    frame_rate DECIMAL(4,2), -- 帧率
    format VARCHAR(10) DEFAULT 'mp4', -- 视频格式
    codec VARCHAR(50), -- 编码格式
    subtitle_urls JSON, -- 字幕文件URL数组
    chapter_info JSON, -- 章节信息
    video_quality ENUM('sd', 'hd', '4k') DEFAULT 'hd',
    is_live BOOLEAN DEFAULT FALSE, -- 是否为直播
    live_stream_url VARCHAR(500), -- 直播流地址
    transcription TEXT, -- 视频转录文字
    video_tags JSON, -- 视频标签
    video_description TEXT, -- 视频描述
    upload_status ENUM('uploading', 'processing', 'completed', 'failed') DEFAULT 'completed',
    cdn_distribution JSON, -- CDN分发信息
    play_count BIGINT DEFAULT 0, -- 播放次数
    download_count INT DEFAULT 0, -- 下载次数
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (news_id) REFERENCES news_metadata(id) ON DELETE CASCADE,
    UNIQUE KEY unique_news_video (news_id),
    INDEX idx_duration (duration),
    INDEX idx_resolution (resolution),
    INDEX idx_video_quality (video_quality),
    INDEX idx_is_live (is_live),
    INDEX idx_play_count (play_count),
    INDEX idx_upload_status (upload_status),
    FULLTEXT idx_transcription_search (transcription, video_description)
);
```

#### 2.6 音频内容表 (audio_content)
```sql
CREATE TABLE audio_content (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    news_id BIGINT NOT NULL, -- 关联资讯元数据
    audio_url VARCHAR(500) NOT NULL, -- 音频文件URL
    backup_audio_urls JSON, -- 备用音频URL数组
    duration INT NOT NULL, -- 音频时长(秒)
    file_size BIGINT, -- 文件大小(字节)
    bitrate INT, -- 比特率
    sample_rate INT, -- 采样率
    format VARCHAR(10) DEFAULT 'mp3', -- 音频格式
    codec VARCHAR(50), -- 编码格式
    voice_type VARCHAR(50), -- 语音类型(AI生成/真人录制)
    voice_gender ENUM('male', 'female', 'mixed') DEFAULT 'female',
    speech_rate DECIMAL(3,1) DEFAULT 1.0, -- 语速倍率
    volume_level DECIMAL(3,2) DEFAULT 1.0, -- 音量级别
    transcription TEXT, -- 音频转录文字
    chapter_timestamps JSON, -- 章节时间戳 [{"title":"...", "start":0, "end":30}]
    related_article_id BIGINT NULL, -- 关联的文章内容ID(支持音频+文章联动)
    sync_reading_enabled BOOLEAN DEFAULT FALSE, -- 是否支持同步阅读
    sync_reading_data JSON, -- 同步阅读数据(文字高亮时间戳)
    audio_quality ENUM('low', 'medium', 'high') DEFAULT 'medium',
    generation_method ENUM('tts', 'human', 'ai_clone') DEFAULT 'tts',
    tts_config JSON, -- TTS生成配置
    background_music_url VARCHAR(500), -- 背景音乐URL
    audio_effects JSON, -- 音效配置
    download_enabled BOOLEAN DEFAULT TRUE, -- 是否允许下载
    offline_enabled BOOLEAN DEFAULT TRUE, -- 是否支持离线
    play_count BIGINT DEFAULT 0, -- 播放次数
    download_count INT DEFAULT 0, -- 下载次数
    completion_rate DECIMAL(5,2) DEFAULT 0, -- 平均完成率
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (news_id) REFERENCES news_metadata(id) ON DELETE CASCADE,
    FOREIGN KEY (related_article_id) REFERENCES article_content(id) ON DELETE SET NULL,
    UNIQUE KEY unique_news_audio (news_id),
    INDEX idx_duration (duration),
    INDEX idx_voice_type (voice_type),
    INDEX idx_generation_method (generation_method),
    INDEX idx_related_article_id (related_article_id),
    INDEX idx_sync_reading_enabled (sync_reading_enabled),
    INDEX idx_play_count (play_count),
    INDEX idx_completion_rate (completion_rate),
    FULLTEXT idx_transcription_search (transcription)
);
```

### 3. AI生成内容系统 (AI Generated Content)

#### 3.1 AI解说内容表 (ai_commentary)
```sql
CREATE TABLE ai_commentary (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    news_id BIGINT NOT NULL, -- 关联资讯元数据
    title VARCHAR(500) NOT NULL,
    script TEXT NOT NULL, -- AI生成的解说稿
    summary VARCHAR(1000), -- 简短摘要
    commentary_style ENUM('news', 'casual', 'humorous', 'professional', 'emotional') DEFAULT 'news',
    target_duration INT, -- 目标时长(秒)
    voice_type VARCHAR(50) DEFAULT 'standard_female',
    language VARCHAR(10) DEFAULT 'zh-CN',
    generation_model VARCHAR(50), -- 使用的AI模型
    generation_prompt TEXT, -- 生成时使用的提示词
    quality_score DECIMAL(3,2), -- 内容质量评分
    is_reviewed BOOLEAN DEFAULT FALSE,
    reviewed_by BIGINT NULL,
    reviewed_at TIMESTAMP NULL,
    is_published BOOLEAN DEFAULT FALSE,
    published_at TIMESTAMP NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (news_id) REFERENCES news_metadata(id) ON DELETE CASCADE,
    FOREIGN KEY (reviewed_by) REFERENCES users(id) ON DELETE SET NULL,
    INDEX idx_news_id (news_id),
    INDEX idx_commentary_style (commentary_style),
    INDEX idx_is_published (is_published),
    INDEX idx_published_at (published_at),
    INDEX idx_quality_score (quality_score)
);
```

#### 3.2 音频文章同步阅读表 (audio_article_sync)
```sql
CREATE TABLE audio_article_sync (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    audio_id BIGINT NOT NULL, -- 音频内容ID
    article_id BIGINT NOT NULL, -- 文章内容ID
    sync_type ENUM('full', 'partial', 'chapter_based') DEFAULT 'full',
    sync_data JSON NOT NULL, -- 同步数据
    -- 同步数据结构示例：
    -- {
    --   "paragraphs": [
    --     {"start_time": 0, "end_time": 15, "text": "段落1内容", "paragraph_id": "p1"},
    --     {"start_time": 15, "end_time": 30, "text": "段落2内容", "paragraph_id": "p2"}
    --   ],
    --   "chapters": [
    --     {"start_time": 0, "end_time": 120, "title": "第一章", "paragraph_ids": ["p1", "p2"]}
    --   ],
    --   "highlights": [
    --     {"start_time": 45, "end_time": 60, "text": "重点内容", "type": "emphasis"}
    --   ]
    -- }
    auto_scroll_enabled BOOLEAN DEFAULT TRUE, -- 是否自动滚动
    highlight_enabled BOOLEAN DEFAULT TRUE, -- 是否文字高亮
    reading_speed_factor DECIMAL(3,2) DEFAULT 1.0, -- 阅读速度系数
    sync_accuracy DECIMAL(3,2) DEFAULT 0.95, -- 同步精度
    last_sync_position INT DEFAULT 0, -- 上次同步位置(秒)
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (audio_id) REFERENCES audio_content(id) ON DELETE CASCADE,
    FOREIGN KEY (article_id) REFERENCES article_content(id) ON DELETE CASCADE,
    UNIQUE KEY unique_audio_article_sync (audio_id, article_id),
    INDEX idx_audio_id (audio_id),
    INDEX idx_article_id (article_id),
    INDEX idx_sync_type (sync_type),
    INDEX idx_is_active (is_active)
);
```

#### 3.3 用户播放进度表 (user_play_progress)
```sql
CREATE TABLE user_play_progress (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    news_id BIGINT NOT NULL, -- 资讯ID
    content_type ENUM('article', 'audio', 'video') NOT NULL,
    content_id BIGINT NOT NULL, -- 对应内容ID
    current_position INT DEFAULT 0, -- 当前播放/阅读位置
    -- 对于音频/视频：秒数
    -- 对于文章：段落ID或字符位置
    total_duration INT DEFAULT 0, -- 总时长/内容长度
    progress_percentage DECIMAL(5,2) DEFAULT 0, -- 进度百分比
    sync_reading_position VARCHAR(50), -- 同步阅读位置标识
    play_count INT DEFAULT 1, -- 播放次数
    bookmark_positions JSON, -- 书签位置数组
    notes JSON, -- 用户笔记
    last_play_mode ENUM('audio_only', 'article_only', 'sync_reading') DEFAULT 'audio_only',
    device_type VARCHAR(20),
    app_version VARCHAR(20),
    last_updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (news_id) REFERENCES news_metadata(id) ON DELETE CASCADE,
    UNIQUE KEY unique_user_content (user_id, news_id, content_type),
    INDEX idx_user_id (user_id),
    INDEX idx_news_id (news_id),
    INDEX idx_content (content_type, content_id),
    INDEX idx_progress_percentage (progress_percentage),
    INDEX idx_last_updated_at (last_updated_at)
);
```

### 4. 社区系统 (Community System)

#### 4.1 用户关注表 (user_follows)
```sql
CREATE TABLE user_follows (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    follower_id BIGINT NOT NULL, -- 关注者ID
    following_id BIGINT NOT NULL, -- 被关注者ID
    follow_type ENUM('user', 'creator', 'journalist') DEFAULT 'user',
    notification_enabled BOOLEAN DEFAULT TRUE, -- 是否接收通知
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    FOREIGN KEY (follower_id) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (following_id) REFERENCES users(id) ON DELETE CASCADE,
    UNIQUE KEY unique_follow (follower_id, following_id),
    INDEX idx_follower_id (follower_id),
    INDEX idx_following_id (following_id),
    INDEX idx_created_at (created_at)
);
```

#### 4.2 评论表 (comments)
```sql
CREATE TABLE comments (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    news_id BIGINT NOT NULL, -- 关联资讯元数据
    content_type ENUM('article', 'audio', 'video') NOT NULL,
    content_id BIGINT NOT NULL, -- 对应具体内容ID
    parent_id BIGINT NULL, -- 父评论ID，用于回复
    content TEXT NOT NULL,
    reply_to_user_id BIGINT NULL, -- 回复的用户ID
    audio_timestamp INT NULL, -- 音频评论对应的时间戳(秒)
    video_timestamp INT NULL, -- 视频评论对应的时间戳(秒)
    article_paragraph_id VARCHAR(50) NULL, -- 文章段落ID
    comment_type ENUM('general', 'timestamped', 'paragraph', 'highlight') DEFAULT 'general',
    like_count INT DEFAULT 0,
    reply_count INT DEFAULT 0,
    is_pinned BOOLEAN DEFAULT FALSE, -- 是否置顶
    is_hidden BOOLEAN DEFAULT FALSE, -- 是否隐藏
    sentiment_score DECIMAL(3,2), -- 情感分数
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (news_id) REFERENCES news_metadata(id) ON DELETE CASCADE,
    FOREIGN KEY (parent_id) REFERENCES comments(id) ON DELETE CASCADE,
    FOREIGN KEY (reply_to_user_id) REFERENCES users(id) ON DELETE SET NULL,
    INDEX idx_user_id (user_id),
    INDEX idx_news_id (news_id),
    INDEX idx_content (content_type, content_id),
    INDEX idx_parent_id (parent_id),
    INDEX idx_timestamps (audio_timestamp, video_timestamp),
    INDEX idx_comment_type (comment_type),
    INDEX idx_created_at (created_at),
    FULLTEXT idx_content_search (content)
);
```

#### 4.3 点赞表 (likes)
```sql
CREATE TABLE likes (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    news_id BIGINT, -- 资讯ID（可选）
    target_type ENUM('news', 'article', 'audio', 'video', 'comment') NOT NULL,
    target_id BIGINT NOT NULL,
    is_like BOOLEAN DEFAULT TRUE, -- TRUE=点赞, FALSE=点踩
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (news_id) REFERENCES news_metadata(id) ON DELETE CASCADE,
    UNIQUE KEY unique_like (user_id, target_type, target_id),
    INDEX idx_user_id (user_id),
    INDEX idx_news_id (news_id),
    INDEX idx_target (target_type, target_id),
    INDEX idx_created_at (created_at)
);
```

#### 4.4 分享记录表 (shares)
```sql
CREATE TABLE shares (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    news_id BIGINT NOT NULL, -- 资讯ID
    content_type ENUM('article', 'audio', 'video') NOT NULL,
    content_id BIGINT NOT NULL,
    share_platform ENUM('wechat', 'weibo', 'qq', 'douyin', 'system', 'link') NOT NULL,
    share_text TEXT, -- 分享时的文案
    share_image_url VARCHAR(500), -- 分享图片
    audio_position INT NULL, -- 音频分享位置(秒)
    video_position INT NULL, -- 视频分享位置(秒)
    article_paragraph_id VARCHAR(50) NULL, -- 文章段落ID
    ip_address VARCHAR(45),
    device_info JSON, -- 设备信息
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (news_id) REFERENCES news_metadata(id) ON DELETE CASCADE,
    INDEX idx_user_id (user_id),
    INDEX idx_news_id (news_id),
    INDEX idx_content (content_type, content_id),
    INDEX idx_platform (share_platform),
    INDEX idx_created_at (created_at)
);
```

#### 4.5 话题表 (topics)
```sql
CREATE TABLE topics (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL UNIQUE,
    description TEXT,
    cover_url VARCHAR(500),
    creator_id BIGINT NOT NULL,
    category_id BIGINT,
    follow_count INT DEFAULT 0,
    content_count INT DEFAULT 0, -- 相关内容数量
    today_content_count INT DEFAULT 0, -- 今日内容数量
    is_trending BOOLEAN DEFAULT FALSE, -- 是否为热门话题
    is_official BOOLEAN DEFAULT FALSE, -- 是否为官方话题
    status ENUM('active', 'archived', 'banned') DEFAULT 'active',
    last_content_at TIMESTAMP NULL, -- 最后内容时间
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (creator_id) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (category_id) REFERENCES news_categories(id) ON DELETE SET NULL,
    INDEX idx_creator_id (creator_id),
    INDEX idx_follow_count (follow_count),
    INDEX idx_is_trending (is_trending),
    INDEX idx_last_content_at (last_content_at),
    FULLTEXT idx_name_search (name, description)
);
```

#### 4.6 话题关注表 (topic_follows)
```sql
CREATE TABLE topic_follows (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    topic_id BIGINT NOT NULL,
    notification_enabled BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (topic_id) REFERENCES topics(id) ON DELETE CASCADE,
    UNIQUE KEY unique_topic_follow (user_id, topic_id),
    INDEX idx_user_id (user_id),
    INDEX idx_topic_id (topic_id)
);
```

### 5. 播放与行为系统 (Play & Behavior System)

#### 5.1 播放历史表 (play_history)
```sql
CREATE TABLE play_history (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    news_id BIGINT NOT NULL, -- 资讯ID
    content_type ENUM('article', 'audio', 'video') NOT NULL,
    content_id BIGINT NOT NULL, -- 对应具体内容ID
    play_duration INT DEFAULT 0, -- 实际播放时长(秒)
    total_duration INT NOT NULL, -- 内容总时长(秒)
    completion_rate DECIMAL(5,2), -- 完成率 0-100
    play_mode ENUM('audio_only', 'article_only', 'sync_reading', 'video_only') DEFAULT 'audio_only',
    sync_reading_active BOOLEAN DEFAULT FALSE, -- 是否开启同步阅读
    play_source ENUM('home', 'category', 'search', 'recommend', 'share') DEFAULT 'home',
    device_type VARCHAR(20), -- mobile, tablet, desktop
    device_info JSON, -- 设备详细信息
    play_speed DECIMAL(3,1) DEFAULT 1.0, -- 播放倍速
    quality VARCHAR(20), -- 播放质量
    network_type ENUM('wifi', '4g', '5g', 'ethernet', 'unknown') DEFAULT 'unknown',
    ip_address VARCHAR(45),
    location_info JSON, -- 地理位置信息
    session_id VARCHAR(64), -- 会话ID
    start_position INT DEFAULT 0, -- 开始播放位置
    end_position INT DEFAULT 0, -- 结束播放位置
    pause_count INT DEFAULT 0, -- 暂停次数
    seek_count INT DEFAULT 0, -- 拖拽次数
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (news_id) REFERENCES news_metadata(id) ON DELETE CASCADE,
    INDEX idx_user_id (user_id),
    INDEX idx_news_id (news_id),
    INDEX idx_content (content_type, content_id),
    INDEX idx_play_mode (play_mode),
    INDEX idx_created_at (created_at),
    INDEX idx_user_content (user_id, content_type, content_id),
    INDEX idx_completion_rate (completion_rate)
);
```

#### 5.2 收藏表 (favorites)
```sql
CREATE TABLE favorites (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    news_id BIGINT NOT NULL, -- 资讯ID
    content_type ENUM('article', 'audio', 'video', 'topic') NOT NULL,
    content_id BIGINT NOT NULL,
    folder_name VARCHAR(50) DEFAULT '默认收藏夹', -- 收藏夹名称
    tags JSON, -- 个人标签
    notes TEXT, -- 收藏备注
    favorite_position INT NULL, -- 收藏时的位置（音频/视频秒数，文章段落）
    favorite_context VARCHAR(200), -- 收藏时的上下文
    is_private BOOLEAN DEFAULT FALSE, -- 是否私有收藏
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (news_id) REFERENCES news_metadata(id) ON DELETE CASCADE,
    UNIQUE KEY unique_favorite (user_id, news_id, content_type),
    INDEX idx_user_id (user_id),
    INDEX idx_news_id (news_id),
    INDEX idx_content (content_type, content_id),
    INDEX idx_folder_name (folder_name),
    INDEX idx_created_at (created_at)
);
```

#### 5.3 用户行为统计表 (user_behavior_stats)
```sql
CREATE TABLE user_behavior_stats (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    date DATE NOT NULL,
    total_play_time INT DEFAULT 0, -- 总播放时长(秒)
    total_play_count INT DEFAULT 0, -- 总播放次数
    audio_play_time INT DEFAULT 0, -- 音频播放时长
    video_play_time INT DEFAULT 0, -- 视频播放时长
    favorite_count INT DEFAULT 0, -- 收藏次数
    share_count INT DEFAULT 0, -- 分享次数
    comment_count INT DEFAULT 0, -- 评论次数
    like_count INT DEFAULT 0, -- 点赞次数
    search_count INT DEFAULT 0, -- 搜索次数
    active_hours JSON, -- 活跃时段分布
    preferred_categories JSON, -- 偏好分类统计
    avg_completion_rate DECIMAL(5,2), -- 平均完成率
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    UNIQUE KEY unique_user_date (user_id, date),
    INDEX idx_user_id (user_id),
    INDEX idx_date (date),
    INDEX idx_total_play_time (total_play_time)
);
```

#### 5.4 内容互动统计表 (content_interaction_stats)
```sql
CREATE TABLE content_interaction_stats (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    content_type ENUM('news', 'audio', 'video') NOT NULL,
    content_id BIGINT NOT NULL,
    date DATE NOT NULL,
    play_count INT DEFAULT 0,
    unique_play_count INT DEFAULT 0, -- 独立播放用户数
    total_play_time INT DEFAULT 0,
    avg_play_time INT DEFAULT 0,
    completion_count INT DEFAULT 0, -- 完整播放次数
    like_count INT DEFAULT 0,
    comment_count INT DEFAULT 0,
    share_count INT DEFAULT 0,
    favorite_count INT DEFAULT 0,
    avg_rating DECIMAL(3,2), -- 平均评分
    bounce_rate DECIMAL(5,2), -- 跳出率
    retention_rate JSON, -- 留存率分布 {"10s": 0.8, "30s": 0.6, ...}
    traffic_source JSON, -- 流量来源统计
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    UNIQUE KEY unique_content_date (content_type, content_id, date),
    INDEX idx_content (content_type, content_id),
    INDEX idx_date (date),
    INDEX idx_play_count (play_count),
    INDEX idx_unique_play_count (unique_play_count)
);
```

### 6. 推荐系统 (Recommendation System)

#### 6.1 用户画像表 (user_profiles)
```sql
CREATE TABLE user_profiles (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    age_group ENUM('18-24', '25-34', '35-44', '45-54', '55+', 'unknown') DEFAULT 'unknown',
    interest_categories JSON, -- 兴趣分类权重 {"tech": 0.8, "finance": 0.6}
    preferred_content_length ENUM('short', 'medium', 'long', 'mixed') DEFAULT 'mixed',
    preferred_time_slots JSON, -- 偏好时段 ["morning", "evening"]
    active_days JSON, -- 活跃星期 [1,2,3,4,5]
    device_preference ENUM('mobile', 'tablet', 'desktop', 'mixed') DEFAULT 'mobile',
    content_freshness_preference DECIMAL(3,2) DEFAULT 0.7, -- 内容新鲜度偏好
    diversity_preference DECIMAL(3,2) DEFAULT 0.5, -- 多样性偏好
    interaction_frequency ENUM('low', 'medium', 'high') DEFAULT 'medium',
    social_activity_level ENUM('lurker', 'commenter', 'sharer', 'creator') DEFAULT 'lurker',
    news_reading_speed ENUM('slow', 'normal', 'fast') DEFAULT 'normal',
    sentiment_preference ENUM('positive', 'neutral', 'negative', 'mixed') DEFAULT 'mixed',
    last_updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    UNIQUE KEY unique_user_profile (user_id),
    INDEX idx_age_group (age_group),
    INDEX idx_interaction_frequency (interaction_frequency)
);
```

#### 6.2 推荐记录表 (recommendations)
```sql
CREATE TABLE recommendations (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    content_type ENUM('news', 'audio', 'video', 'topic') NOT NULL,
    content_id BIGINT NOT NULL,
    algorithm_type ENUM('collaborative', 'content_based', 'trending', 'social', 'location', 'time_based') NOT NULL,
    recommendation_score DECIMAL(5,4) NOT NULL, -- 推荐分数 0-1
    confidence_score DECIMAL(5,4), -- 置信度分数
    reasons JSON, -- 推荐原因 ["similar_users_liked", "matching_interests"]
    context_info JSON, -- 推荐上下文信息
    position_in_list INT, -- 在推荐列表中的位置
    list_type ENUM('home_feed', 'category_feed', 'search_related', 'similar_content') DEFAULT 'home_feed',
    is_viewed BOOLEAN DEFAULT FALSE,
    is_clicked BOOLEAN DEFAULT FALSE,
    is_played BOOLEAN DEFAULT FALSE,
    is_liked BOOLEAN DEFAULT FALSE,
    is_shared BOOLEAN DEFAULT FALSE,
    interaction_time TIMESTAMP NULL, -- 首次交互时间
    session_id VARCHAR(64),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    INDEX idx_user_id (user_id),
    INDEX idx_content (content_type, content_id),
    INDEX idx_algorithm_type (algorithm_type),
    INDEX idx_recommendation_score (recommendation_score),
    INDEX idx_created_at (created_at),
    INDEX idx_session_id (session_id)
);
```

#### 6.3 热点趋势表 (trending_topics)
```sql
CREATE TABLE trending_topics (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    keyword VARCHAR(100) NOT NULL,
    category_id BIGINT,
    trend_type ENUM('breaking', 'rising', 'hot', 'persistent') NOT NULL,
    mention_count INT DEFAULT 0, -- 提及次数
    search_count INT DEFAULT 0, -- 搜索次数
    engagement_score DECIMAL(8,4) DEFAULT 0, -- 参与度分数
    velocity_score DECIMAL(8,4) DEFAULT 0, -- 增长速度分数
    related_news_count INT DEFAULT 0, -- 相关新闻数量
    geographic_scope ENUM('global', 'national', 'regional', 'local') DEFAULT 'national',
    age_group_distribution JSON, -- 年龄组分布
    peak_time TIME, -- 高峰时间
    trend_start_time TIMESTAMP,
    trend_end_time TIMESTAMP NULL,
    related_keywords JSON, -- 相关关键词
    sentiment_distribution JSON, -- 情感分布 {"positive": 0.4, "neutral": 0.4, "negative": 0.2}
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (category_id) REFERENCES news_categories(id) ON DELETE SET NULL,
    INDEX idx_keyword (keyword),
    INDEX idx_trend_type (trend_type),
    INDEX idx_engagement_score (engagement_score),
    INDEX idx_velocity_score (velocity_score),
    INDEX idx_is_active (is_active),
    INDEX idx_created_at (created_at),
    FULLTEXT idx_keyword_search (keyword)
);
```

### 7. 通知系统 (Notification System)

#### 7.1 通知表 (notifications)
```sql
CREATE TABLE notifications (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    notification_type ENUM('comment', 'like', 'follow', 'share', 'system', 'news_update', 'recommendation') NOT NULL,
    title VARCHAR(200) NOT NULL,
    content TEXT NOT NULL,
    data JSON, -- 通知相关数据
    sender_id BIGINT NULL, -- 发送者ID (如果适用)
    related_type ENUM('news', 'audio', 'video', 'comment', 'user', 'topic') NULL,
    related_id BIGINT NULL,
    action_url VARCHAR(500), -- 点击跳转链接
    priority ENUM('low', 'normal', 'high', 'urgent') DEFAULT 'normal',
    is_read BOOLEAN DEFAULT FALSE,
    is_clicked BOOLEAN DEFAULT FALSE,
    read_at TIMESTAMP NULL,
    clicked_at TIMESTAMP NULL,
    expires_at TIMESTAMP NULL, -- 过期时间
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (sender_id) REFERENCES users(id) ON DELETE SET NULL,
    INDEX idx_user_id (user_id),
    INDEX idx_notification_type (notification_type),
    INDEX idx_is_read (is_read),
    INDEX idx_priority (priority),
    INDEX idx_created_at (created_at),
    INDEX idx_expires_at (expires_at)
);
```

#### 7.2 推送记录表 (push_records)
```sql
CREATE TABLE push_records (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    notification_id BIGINT,
    user_id BIGINT NOT NULL,
    push_type ENUM('app_push', 'email', 'sms', 'wechat') NOT NULL,
    target_address VARCHAR(255), -- 推送目标地址
    title VARCHAR(200),
    content TEXT,
    push_data JSON, -- 推送载荷数据
    push_service VARCHAR(50), -- 推送服务商
    status ENUM('pending', 'sent', 'delivered', 'failed', 'clicked') DEFAULT 'pending',
    error_message TEXT,
    retry_count INT DEFAULT 0,
    scheduled_at TIMESTAMP NULL, -- 计划发送时间
    sent_at TIMESTAMP NULL,
    delivered_at TIMESTAMP NULL,
    clicked_at TIMESTAMP NULL,
    device_token VARCHAR(255), -- 设备推送令牌
    device_type VARCHAR(20),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (notification_id) REFERENCES notifications(id) ON DELETE SET NULL,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    INDEX idx_notification_id (notification_id),
    INDEX idx_user_id (user_id),
    INDEX idx_push_type (push_type),
    INDEX idx_status (status),
    INDEX idx_scheduled_at (scheduled_at),
    INDEX idx_created_at (created_at)
);
```

## 9. 管理后台系统 (Admin System)

#### 9.1 管理员表 (admin_users)
```sql
CREATE TABLE admin_users (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    name VARCHAR(100) NOT NULL,
    avatar_url VARCHAR(255),
    role ENUM('super_admin', 'admin', 'editor', 'moderator') NOT NULL,
    permissions JSON, -- 权限列表
    is_active BOOLEAN DEFAULT TRUE,
    last_login_at TIMESTAMP NULL,
    last_login_ip VARCHAR(45),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    INDEX idx_username (username),
    INDEX idx_email (email),
    INDEX idx_role (role)
);
```

#### 9.2 内容审核表 (content_moderation)
```sql
CREATE TABLE content_moderation (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    content_type ENUM('news', 'audio', 'video', 'comment') NOT NULL,
    content_id BIGINT NOT NULL,
    status ENUM('pending', 'approved', 'rejected', 'flagged') DEFAULT 'pending',
    moderator_id BIGINT,
    moderation_reason TEXT,
    ai_score DECIMAL(3,2), -- AI审核分数
    ai_flags JSON, -- AI标记的问题
    user_reports_count INT DEFAULT 0,
    priority ENUM('low', 'normal', 'high', 'urgent') DEFAULT 'normal',
    moderated_at TIMESTAMP NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (moderator_id) REFERENCES admin_users(id) ON DELETE SET NULL,
    INDEX idx_content (content_type, content_id),
    INDEX idx_status (status),
    INDEX idx_priority (priority),
    INDEX idx_moderator_id (moderator_id),
    INDEX idx_created_at (created_at)
);
```

## 10. 搜索系统 (Search System)

#### 10.1 搜索历史表 (search_history)
```sql
CREATE TABLE search_history (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT,
    query VARCHAR(200) NOT NULL,
    search_type ENUM('news', 'topic', 'user', 'general') DEFAULT 'general',
    result_count INT DEFAULT 0,
    filter_conditions JSON, -- 搜索筛选条件
    clicked_result_id BIGINT NULL, -- 点击的结果ID
    clicked_result_type ENUM('news', 'audio', 'video', 'topic', 'user') NULL,
    session_id VARCHAR(64),
    ip_address VARCHAR(45),
    device_info JSON,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE SET NULL,
    INDEX idx_user_id (user_id),
    INDEX idx_query (query),
    INDEX idx_search_type (search_type),
    INDEX idx_created_at (created_at),
    FULLTEXT idx_query_search (query)
);
```

#### 10.2 热门搜索表 (popular_searches)
```sql
CREATE TABLE popular_searches (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    keyword VARCHAR(100) NOT NULL,
    search_count INT DEFAULT 1,
    category_id BIGINT,
    date DATE NOT NULL,
    hour_distribution JSON, -- 24小时搜索分布
    age_group_distribution JSON, -- 年龄组搜索分布
    region_distribution JSON, -- 地区搜索分布
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (category_id) REFERENCES news_categories(id) ON DELETE SET NULL,
    UNIQUE KEY unique_keyword_date (keyword, date),
    INDEX idx_keyword (keyword),
    INDEX idx_search_count (search_count),
    INDEX idx_date (date)
);
```

### 8. 系统配置与内容标签 (System Configuration)

#### 8.1 系统配置表 (system_configs)
```sql
CREATE TABLE system_configs (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    config_key VARCHAR(100) UNIQUE NOT NULL,
    config_value TEXT NOT NULL,
    description TEXT,
    data_type ENUM('string', 'int', 'float', 'boolean', 'json') DEFAULT 'string',
    is_encrypted BOOLEAN DEFAULT FALSE, -- 是否加密存储
    category ENUM('app', 'ai', 'content', 'notification', 'payment') DEFAULT 'app',
    is_public BOOLEAN DEFAULT FALSE, -- 是否可公开访问
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    INDEX idx_config_key (config_key),
    INDEX idx_category (category),
    INDEX idx_is_public (is_public)
);
```

#### 8.2 内容标签表 (content_tags)
```sql
CREATE TABLE content_tags (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(50) NOT NULL UNIQUE,
    category ENUM('topic', 'emotion', 'difficulty', 'length', 'quality') DEFAULT 'topic',
    color_code VARCHAR(7), -- 标签颜色
    icon_url VARCHAR(255), -- 标签图标
    description TEXT,
    usage_count INT DEFAULT 0, -- 使用次数
    is_system_tag BOOLEAN DEFAULT FALSE, -- 是否为系统标签
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    INDEX idx_name (name),
    INDEX idx_category (category),
    INDEX idx_usage_count (usage_count),
    INDEX idx_is_system_tag (is_system_tag)
);
```

#### 8.3 内容标签关联表 (content_tag_relations)
```sql
CREATE TABLE content_tag_relations (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    content_type ENUM('news', 'audio', 'video', 'commentary') NOT NULL,
    content_id BIGINT NOT NULL,
    tag_id BIGINT NOT NULL,
    relevance_score DECIMAL(3,2) DEFAULT 1.0, -- 相关性分数
    is_auto_tagged BOOLEAN DEFAULT FALSE, -- 是否为AI自动标注
    tagged_by BIGINT NULL, -- 标注者ID
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    FOREIGN KEY (tag_id) REFERENCES content_tags(id) ON DELETE CASCADE,
    FOREIGN KEY (tagged_by) REFERENCES admin_users(id) ON DELETE SET NULL,
    UNIQUE KEY unique_content_tag (content_type, content_id, tag_id),
    INDEX idx_content (content_type, content_id),
    INDEX idx_tag_id (tag_id),
    INDEX idx_relevance_score (relevance_score)
);
```

#### 8.4 AI模型配置表 (ai_model_configs)
```sql
CREATE TABLE ai_model_configs (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    model_name VARCHAR(100) NOT NULL,
    model_type ENUM('text_generation', 'text_to_speech', 'video_generation', 'image_generation', 'translation') NOT NULL,
    provider VARCHAR(50) NOT NULL, -- openai, azure, anthropic等
    api_endpoint VARCHAR(255),
    model_version VARCHAR(50),
    max_tokens INT,
    temperature DECIMAL(3,2),
    top_p DECIMAL(3,2),
    frequency_penalty DECIMAL(3,2),
    presence_penalty DECIMAL(3,2),
    cost_per_token DECIMAL(8,6), -- 每token成本
    rate_limit_rpm INT, -- 每分钟请求限制
    rate_limit_tpm INT, -- 每分钟token限制
    is_active BOOLEAN DEFAULT TRUE,
    priority INT DEFAULT 1, -- 优先级，数字越小优先级越高
    config_json JSON, -- 其他配置参数
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    INDEX idx_model_type (model_type),
    INDEX idx_provider (provider),
    INDEX idx_is_active (is_active),
    INDEX idx_priority (priority)
);
```

#### 8.5 API使用统计表 (api_usage_stats)
```sql
CREATE TABLE api_usage_stats (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    model_config_id BIGINT NOT NULL,
    date DATE NOT NULL,
    request_count INT DEFAULT 0,
    token_count BIGINT DEFAULT 0,
    success_count INT DEFAULT 0,
    error_count INT DEFAULT 0,
    total_cost DECIMAL(10,4) DEFAULT 0,
    avg_response_time INT DEFAULT 0, -- 平均响应时间(ms)
    peak_hour INT, -- 峰值小时
    error_types JSON, -- 错误类型统计
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (model_config_id) REFERENCES ai_model_configs(id) ON DELETE CASCADE,
    UNIQUE KEY unique_model_date (model_config_id, date),
    INDEX idx_model_config_id (model_config_id),
    INDEX idx_date (date),
    INDEX idx_total_cost (total_cost)
);
```

#### 8.6 内容生成任务表 (content_generation_tasks)
```sql
CREATE TABLE content_generation_tasks (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    task_type ENUM('text_generation', 'audio_generation', 'video_generation', 'translation') NOT NULL,
    raw_news_id BIGINT NOT NULL,
    model_config_id BIGINT NOT NULL,
    input_data JSON NOT NULL, -- 输入数据
    output_data JSON, -- 输出数据
    status ENUM('pending', 'processing', 'completed', 'failed', 'cancelled') DEFAULT 'pending',
    priority ENUM('low', 'normal', 'high', 'urgent') DEFAULT 'normal',
    progress_percentage INT DEFAULT 0,
    estimated_duration INT, -- 预估耗时(秒)
    actual_duration INT, -- 实际耗时(秒)
    error_message TEXT,
    retry_count INT DEFAULT 0,
    max_retries INT DEFAULT 3,
    scheduled_at TIMESTAMP NULL, -- 计划执行时间
    started_at TIMESTAMP NULL,
    completed_at TIMESTAMP NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (raw_news_id) REFERENCES raw_news(id) ON DELETE CASCADE,
    FOREIGN KEY (model_config_id) REFERENCES ai_model_configs(id) ON DELETE RESTRICT,
    INDEX idx_task_type (task_type),
    INDEX idx_status (status),
    INDEX idx_priority (priority),
    INDEX idx_scheduled_at (scheduled_at),
    INDEX idx_created_at (created_at)
);
```

## 数据库索引优化策略

### 针对AI资讯平台的核心查询索引
```sql
-- 首页资讯推荐查询 (按热度、时间、分类)
CREATE INDEX idx_news_recommend ON ai_commentary(is_published, published_at, quality_score, commentary_style);

-- 分类内容查询
CREATE INDEX idx_category_content ON raw_news(category_id, is_processed, importance_score, published_at);

-- 用户播放历史查询 (最近播放、收藏等)
CREATE INDEX idx_user_play_recent ON play_history(user_id, created_at DESC, content_type);

-- 热门内容排行
CREATE INDEX idx_content_trending ON ai_audio_content(is_active, play_count DESC, created_at);

-- 推荐系统查询
CREATE INDEX idx_recommendation_user ON recommendations(user_id, recommendation_score DESC, created_at);

-- 评论系统查询
CREATE INDEX idx_comments_content ON comments(content_type, content_id, is_hidden, created_at);

-- AI任务队列优化
CREATE INDEX idx_generation_tasks_queue ON content_generation_tasks(status, priority, scheduled_at, created_at);

-- 内容标签查询优化
CREATE INDEX idx_content_tags_search ON content_tag_relations(content_type, content_id, relevance_score DESC);

-- 系统配置快速访问
CREATE INDEX idx_system_config_public ON system_configs(is_public, category, config_key);

-- API使用成本统计
CREATE INDEX idx_api_cost_analysis ON api_usage_stats(date, total_cost DESC, model_config_id);
```

### 复合索引优化
```sql
-- 用户行为分析
CREATE INDEX idx_user_behavior_analysis ON user_behavior_stats(user_id, date, total_play_time);

-- 内容互动统计
CREATE INDEX idx_content_stats ON content_interaction_stats(content_type, content_id, date, play_count);

-- 社交关系查询
CREATE INDEX idx_user_follows_relation ON user_follows(follower_id, following_id, follow_type);

-- 通知查询优化
CREATE INDEX idx_notifications_user ON notifications(user_id, is_read, priority, created_at);

-- 搜索统计优化
CREATE INDEX idx_search_trends ON popular_searches(date, search_count DESC, keyword);

-- AI内容质量筛选
CREATE INDEX idx_ai_content_quality ON ai_commentary(quality_score DESC, is_published, commentary_style, published_at);

-- 用户画像分析
CREATE INDEX idx_user_profile_analysis ON user_profiles(age_group, interaction_frequency, last_updated_at);

-- 热点趋势分析
CREATE INDEX idx_trending_analysis ON trending_topics(trend_type, engagement_score DESC, is_active, created_at);

-- 内容审核队列
CREATE INDEX idx_moderation_queue ON content_moderation(status, priority, created_at, content_type);

-- 推送记录分析
CREATE INDEX idx_push_performance ON push_records(push_type, status, sent_at, user_id);
```

### 全文搜索索引优化
```sql
-- 新闻内容全文搜索 (已在表定义中包含)
-- 评论内容搜索 (已在表定义中包含)
-- 话题搜索 (已在表定义中包含)

-- 额外的搜索优化索引
CREATE INDEX idx_news_search_weight ON raw_news(importance_score DESC, published_at DESC, category_id);
CREATE INDEX idx_commentary_search_weight ON ai_commentary(quality_score DESC, published_at DESC, commentary_style);

-- 搜索关键词统计
CREATE INDEX idx_search_keyword_stats ON search_history(query, search_type, created_at);
```

### 分区策略建议
```sql
-- 播放历史表按月分区 (大数据量表)
ALTER TABLE play_history PARTITION BY RANGE (YEAR(created_at) * 100 + MONTH(created_at)) (
    PARTITION p202401 VALUES LESS THAN (202402),
    PARTITION p202402 VALUES LESS THAN (202403),
    PARTITION p202403 VALUES LESS THAN (202404),
    PARTITION p202404 VALUES LESS THAN (202405),
    PARTITION p202405 VALUES LESS THAN (202406),
    PARTITION p202406 VALUES LESS THAN (202407),
    PARTITION p202407 VALUES LESS THAN (202408),
    PARTITION p202408 VALUES LESS THAN (202409),
    PARTITION p202409 VALUES LESS THAN (202410),
    PARTITION p202410 VALUES LESS THAN (202411),
    PARTITION p202411 VALUES LESS THAN (202412),
    PARTITION p202412 VALUES LESS THAN (202501),
    PARTITION p_future VALUES LESS THAN MAXVALUE
);

-- 用户行为统计表按年分区
ALTER TABLE user_behavior_stats PARTITION BY RANGE (YEAR(date)) (
    PARTITION p2024 VALUES LESS THAN (2025),
    PARTITION p2025 VALUES LESS THAN (2026),
    PARTITION p2026 VALUES LESS THAN (2027),
    PARTITION p_future VALUES LESS THAN MAXVALUE
);

-- 内容互动统计表按年分区
ALTER TABLE content_interaction_stats PARTITION BY RANGE (YEAR(date)) (
    PARTITION p2024 VALUES LESS THAN (2025),
    PARTITION p2025 VALUES LESS THAN (2026),
    PARTITION p2026 VALUES LESS THAN (2027),
    PARTITION p_future VALUES LESS THAN MAXVALUE
);

-- 搜索历史表按月分区
ALTER TABLE search_history PARTITION BY RANGE (YEAR(created_at) * 100 + MONTH(created_at)) (
    PARTITION p202401 VALUES LESS THAN (202402),
    PARTITION p202402 VALUES LESS THAN (202403),
    PARTITION p202403 VALUES LESS THAN (202404),
    PARTITION p202404 VALUES LESS THAN (202405),
    PARTITION p202405 VALUES LESS THAN (202406),
    PARTITION p202406 VALUES LESS THAN (202407),
    PARTITION p202407 VALUES LESS THAN (202408),
    PARTITION p202408 VALUES LESS THAN (202409),
    PARTITION p202409 VALUES LESS THAN (202410),
    PARTITION p202410 VALUES LESS THAN (202411),
    PARTITION p202411 VALUES LESS THAN (202412),
    PARTITION p202412 VALUES LESS THAN (202501),
    PARTITION p_future VALUES LESS THAN MAXVALUE
);

-- API使用统计表按月分区
ALTER TABLE api_usage_stats PARTITION BY RANGE (YEAR(date) * 100 + MONTH(date)) (
    PARTITION p202401 VALUES LESS THAN (202402),
    PARTITION p202402 VALUES LESS THAN (202403),
    -- ... 继续按月分区
    PARTITION p_future VALUES LESS THAN MAXVALUE
);
```

### 数据归档与清理策略
```sql
-- 创建归档表结构
CREATE TABLE play_history_archive LIKE play_history;
CREATE TABLE search_history_archive LIKE search_history;
CREATE TABLE notifications_archive LIKE notifications;

-- 归档脚本示例 (定期执行)
-- 1. 播放历史数据归档 (保留6个月)
INSERT INTO play_history_archive 
SELECT * FROM play_history 
WHERE created_at < DATE_SUB(NOW(), INTERVAL 6 MONTH);

DELETE FROM play_history 
WHERE created_at < DATE_SUB(NOW(), INTERVAL 6 MONTH);

-- 2. 搜索历史数据清理 (匿名用户3个月，注册用户12个月)
DELETE FROM search_history 
WHERE user_id IS NULL 
AND created_at < DATE_SUB(NOW(), INTERVAL 3 MONTH);

DELETE FROM search_history 
WHERE user_id IS NOT NULL 
AND created_at < DATE_SUB(NOW(), INTERVAL 12 MONTH);

-- 3. 通知数据清理 (已读通知30天，未读通知90天)
DELETE FROM notifications 
WHERE is_read = TRUE 
AND read_at < DATE_SUB(NOW(), INTERVAL 30 DAY);

DELETE FROM notifications 
WHERE is_read = FALSE 
AND created_at < DATE_SUB(NOW(), INTERVAL 90 DAY);

-- 4. AI任务记录清理 (完成的任务保留30天)
DELETE FROM content_generation_tasks 
WHERE status IN ('completed', 'failed', 'cancelled') 
AND completed_at < DATE_SUB(NOW(), INTERVAL 30 DAY);

-- 5. 推送记录清理 (成功推送保留7天，失败推送保留30天)
DELETE FROM push_records 
WHERE status = 'delivered' 
AND delivered_at < DATE_SUB(NOW(), INTERVAL 7 DAY);

DELETE FROM push_records 
WHERE status = 'failed' 
AND created_at < DATE_SUB(NOW(), INTERVAL 30 DAY);
```

## 数据初始化脚本

### 默认分类数据
```sql
INSERT INTO news_categories (name, name_en, description, color_code, sort_order, keywords) VALUES
('科技', 'Technology', 'AI、互联网、科技创新相关资讯', '#4CD964', 1, '["AI", "人工智能", "科技", "互联网", "创新"]'),
('财经', 'Finance', '经济、金融、股市相关资讯', '#FF3B30', 2, '["经济", "金融", "股市", "投资", "财经"]'),
('国际', 'International', '国际新闻、全球资讯', '#007AFF', 3, '["国际", "全球", "外交", "国外"]'),
('社会', 'Society', '社会民生、热点事件', '#FF9500', 4, '["社会", "民生", "热点", "事件"]'),
('娱乐', 'Entertainment', '娱乐圈、明星、影视资讯', '#5856D6', 5, '["娱乐", "明星", "影视", "综艺"]'),
('体育', 'Sports', '体育赛事、运动资讯', '#34C759', 6, '["体育", "运动", "赛事", "比赛"]'),
('健康', 'Health', '健康养生、医疗资讯', '#FF2D92', 7, '["健康", "医疗", "养生", "保健"]'),
('教育', 'Education', '教育资讯、学习相关', '#32D74B', 8, '["教育", "学习", "考试", "培训"]');
```

### 系统配置初始化
```sql
INSERT INTO system_configs (config_key, config_value, description, data_type) VALUES
('app_name', '羊咩快报', '应用名称', 'string'),
('app_version', '1.0.0', '应用版本', 'string'),
('ai_voice_default', 'standard_female', '默认AI语音类型', 'string'),
('content_cache_duration', '3600', '内容缓存时长(秒)', 'int'),
('max_daily_tts_quota', '100', '用户每日TTS配额', 'int'),
('recommendation_refresh_interval', '1800', '推荐内容刷新间隔(秒)', 'int'),
('trending_update_interval', '300', '热点趋势更新间隔(秒)', 'int'),
('news_crawl_interval', '1800', '新闻爬取间隔(秒)', 'int'),
('ai_content_generation_queue_size', '50', 'AI内容生成队列大小', 'int'),
('push_notification_enabled', 'true', '是否启用推送通知', 'boolean'),
('content_moderation_ai_threshold', '0.8', 'AI内容审核阈值', 'float');
```

### 默认AI语音类型
```sql
-- 可以创建一个语音类型配置表
CREATE TABLE voice_types (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(50) NOT NULL UNIQUE,
    display_name VARCHAR(100) NOT NULL,
    gender ENUM('male', 'female') NOT NULL,
    language VARCHAR(10) DEFAULT 'zh-CN',
    provider VARCHAR(50), -- 服务提供商
    sample_url VARCHAR(500), -- 试听链接
    is_premium BOOLEAN DEFAULT FALSE,
    is_active BOOLEAN DEFAULT TRUE,
    sort_order INT DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

INSERT INTO voice_types (name, display_name, gender, language, provider, is_premium, sort_order) VALUES
('standard_female', '标准女声', 'female', 'zh-CN', 'system', false, 1),
('standard_male', '标准男声', 'male', 'zh-CN', 'system', false, 2),
('sweet_female', '甜美女声', 'female', 'zh-CN', 'system', true, 3),
('magnetic_male', '磁性男声', 'male', 'zh-CN', 'system', true, 4),
('news_female', '新闻女播', 'female', 'zh-CN', 'system', false, 5),
('news_male', '新闻男播', 'male', 'zh-CN', 'system', false, 6);
```

### 默认AI模型配置
```sql
INSERT INTO ai_model_configs (model_name, model_type, provider, api_endpoint, model_version, max_tokens, temperature, cost_per_token, rate_limit_rpm, is_active, priority) VALUES
-- 文本生成模型
('gpt-4o', 'text_generation', 'openai', 'https://api.openai.com/v1/chat/completions', 'gpt-4o', 4096, 0.7, 0.00003, 500, TRUE, 1),
('gpt-3.5-turbo', 'text_generation', 'openai', 'https://api.openai.com/v1/chat/completions', 'gpt-3.5-turbo', 4096, 0.7, 0.000002, 3500, TRUE, 2),
('claude-3-sonnet', 'text_generation', 'anthropic', 'https://api.anthropic.com/v1/messages', 'claude-3-sonnet-20240229', 4096, 0.7, 0.000015, 1000, TRUE, 1),

-- 语音合成模型
('azure-neural-voice', 'text_to_speech', 'azure', 'https://eastus.tts.speech.microsoft.com/cognitiveservices/v1', 'neural', NULL, NULL, 0.000016, 200, TRUE, 1),
('elevenlabs-voice', 'text_to_speech', 'elevenlabs', 'https://api.elevenlabs.io/v1/text-to-speech', 'eleven_multilingual_v2', NULL, NULL, 0.00018, 100, TRUE, 2),
('xunfei-tts', 'text_to_speech', 'xunfei', 'https://api.xfyun.cn/v2/tts', 'v2', NULL, NULL, 0.000008, 500, TRUE, 3),

-- 视频生成模型
('runway-gen2', 'video_generation', 'runway', 'https://api.runwayml.com/v1/generate', 'gen-2', NULL, NULL, 0.1, 10, TRUE, 1),
('stable-video', 'video_generation', 'stability', 'https://api.stability.ai/v2beta/image-to-video', 'svd-1.1', NULL, NULL, 0.04, 50, TRUE, 2),

-- 图像生成模型
('dall-e-3', 'image_generation', 'openai', 'https://api.openai.com/v1/images/generations', 'dall-e-3', NULL, NULL, 0.04, 100, TRUE, 1),
('midjourney', 'image_generation', 'midjourney', 'https://api.midjourney.com/v1/imagine', 'v6', NULL, NULL, 0.02, 200, TRUE, 2);
```

### 默认系统配置扩展
```sql
INSERT INTO system_configs (config_key, config_value, description, data_type, category) VALUES
-- AI相关配置
('ai_content_generation_enabled', 'true', '是否启用AI内容生成', 'boolean', 'ai'),
('ai_max_daily_generation_quota', '1000', '每日AI生成配额', 'int', 'ai'),
('ai_content_quality_threshold', '0.7', 'AI内容质量阈值', 'float', 'ai'),
('ai_auto_publish_threshold', '0.9', 'AI内容自动发布阈值', 'float', 'ai'),
('ai_voice_clone_enabled', 'false', '是否启用语音克隆', 'boolean', 'ai'),

-- 内容相关配置
('content_auto_categorization', 'true', '是否自动分类内容', 'boolean', 'content'),
('content_duplicate_check_enabled', 'true', '是否启用重复内容检查', 'boolean', 'content'),
('content_sentiment_analysis_enabled', 'true', '是否启用情感分析', 'boolean', 'content'),
('content_trending_update_interval', '300', '热点内容更新间隔(秒)', 'int', 'content'),
('content_cache_ttl', '3600', '内容缓存TTL(秒)', 'int', 'content'),

-- 通知配置
('notification_daily_limit_per_user', '50', '用户每日通知限制', 'int', 'notification'),
('notification_batch_size', '100', '通知批处理大小', 'int', 'notification'),
('notification_retry_max_attempts', '3', '通知重试最大次数', 'int', 'notification'),
('notification_quiet_hours_start', '22', '免打扰开始时间', 'int', 'notification'),
('notification_quiet_hours_end', '8', '免打扰结束时间', 'int', 'notification'),

-- 支付配置
('payment_wechat_enabled', 'true', '是否启用微信支付', 'boolean', 'payment'),
('payment_alipay_enabled', 'true', '是否启用支付宝', 'boolean', 'payment'),
('payment_premium_monthly_price', '19.9', '月度会员价格', 'float', 'payment'),
('payment_premium_yearly_price', '199', '年度会员价格', 'float', 'payment'),
('payment_refund_enabled', 'true', '是否支持退款', 'boolean', 'payment');
```

## 性能优化建议

### 1. 数据库层面优化
- **连接池配置**: 根据并发量调整MySQL连接池大小
- **查询缓存**: 启用查询缓存，缓存频繁查询的结果
- **慢查询监控**: 设置慢查询日志，定期优化慢SQL
- **表结构优化**: 定期分析表结构，优化字段类型和长度

### 2. 索引优化策略
- **覆盖索引**: 为常用查询创建覆盖索引，减少回表操作
- **索引维护**: 定期分析索引使用情况，删除无用索引
- **分区索引**: 对大表使用分区，每个分区独立维护索引
- **前缀索引**: 对长字符串字段使用前缀索引

### 3. 缓存策略
```sql
-- Redis缓存键设计
热门内容: "hot:content:{type}:{period}" -- 如 hot:content:news:24h
用户推荐: "recommend:user:{user_id}:{timestamp}"
分类内容: "category:content:{category_id}:{page}"
搜索结果: "search:{query_hash}:{filters_hash}"
用户画像: "profile:user:{user_id}"
热点趋势: "trending:topics:{date}"
```

### 4. 数据归档策略
- **播放历史**: 6个月后归档到历史表
- **搜索记录**: 3个月后清理匿名搜索记录
- **通知记录**: 1个月后删除已读通知
- **操作日志**: 按月分表，1年后归档

### 5. 读写分离建议
```sql
-- 读库优化 (从库配置)
- 播放历史查询
- 内容浏览
- 搜索功能
- 统计分析

-- 写库操作 (主库)
- 用户注册登录
- 内容发布
- 互动操作(点赞、评论)
- 后台管理
```

### 6. 监控指标
- **QPS监控**: 查询每秒数量
- **慢查询**: >1秒的查询统计
- **连接数**: 数据库连接使用情况
- **缓存命中率**: Redis缓存效率
- **存储空间**: 表大小和增长趋势
- **索引效率**: 索引使用率统计

### 7. 容量规划
- **用户增长**: 预估用户增长，规划存储需求
- **内容增长**: AI生成内容的存储规划
- **历史数据**: 播放历史等大数据量表的容量规划
- **备份策略**: 全量备份 + 增量备份方案

## 安全考虑

### 1. 数据安全
- **敏感信息加密**: 用户密码、个人信息加密存储
- **访问控制**: 数据库用户权限最小化原则
- **SQL注入防护**: 使用参数化查询
- **数据脱敏**: 生产数据用于测试时进行脱敏

### 2. 隐私保护
- **用户行为数据**: 合规收集和使用用户数据
- **地理位置**: 位置信息加密存储
- **设备信息**: 设备标识符哈希处理
- **数据保留**: 设置数据保留期限

---

*此数据库设计文档针对羊咩快报AI资讯平台的特点进行了专门优化，涵盖了从基础用户管理到AI内容生成、社区互动、推荐系统等全方位的数据模型。随着业务发展，可根据实际需求进行调整和扩展。*